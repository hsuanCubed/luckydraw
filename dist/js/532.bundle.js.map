{"version":3,"file":"532.bundle.js?v=fb20054111c08e581fa2","mappings":"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","sources":["webpack:///./components/GetLuckyBox/main.vue","webpack:///components/GetLuckyBox/main.vue","webpack:///./components/GetLuckyBox/main.vue?bfc7","webpack:///./components/GetLuckyBox/main.vue?dcfa"],"sourcesContent":["var render = function render() {\n  var _vm = this,\n    _c = _vm._self._c\n  return _c(\n    \"div\",\n    {\n      ref: \"box\",\n      staticClass: \"modal\",\n      attrs: {\n        id: \"GetLuckyBox\",\n        tabindex: \"-1\",\n        role: \"dialog\",\n        \"data-backdrop\": \"static\",\n        \"data-keyboard\": \"false\",\n      },\n    },\n    [\n      _c(\"div\", { staticClass: \"modal-dialog\", attrs: { role: \"document\" } }, [\n        _c(\"div\", { staticClass: \"modal-content\" }, [\n          _vm._m(0),\n          _vm._v(\" \"),\n          _c(\"div\", { staticClass: \"modal-body\" }, [\n            _vm.needSetWebTitle\n              ? _c(\n                  \"div\",\n                  {\n                    staticClass: \"alert alert-primary\",\n                    staticStyle: { flex: \"0 0 auto\" },\n                    attrs: { role: \"alert\" },\n                  },\n                  [\n                    _vm._v(\n                      \"\\n                    請先設定屬於您的抽獎活動名稱\\n                    \"\n                    ),\n                    _c(\n                      \"button\",\n                      {\n                        staticClass: \"btn btn-success btn-sm\",\n                        on: { click: _vm.gotoSetWebTitle },\n                      },\n                      [_vm._v(\"立刻去\")]\n                    ),\n                  ]\n                )\n              : _vm._e(),\n            _vm._v(\" \"),\n            _c(\n              \"div\",\n              {\n                staticClass: \"get-lucky-list\",\n                class: { disabled: _vm.needSetWebTitle },\n              },\n              [\n                _vm.prizeListByAward.length > 0\n                  ? _vm._l(_vm.prizeListByAward, function (prizeInfo) {\n                      return _c(\n                        \"button\",\n                        {\n                          key: prizeInfo.prize_sn,\n                          staticClass:\n                            \"btn btn-success btn-lg btn-block mb-3 prizeInfo\",\n                          attrs: {\n                            type: \"button\",\n                            disabled: prizeInfo.amount <= prizeInfo.count,\n                          },\n                          on: {\n                            click: function ($event) {\n                              return _vm.getLucky(prizeInfo)\n                            },\n                          },\n                        },\n                        [\n                          _c(\"div\", { staticClass: \"row\" }, [\n                            _c(\"div\", { staticClass: \"col-9\" }, [\n                              _vm._v(\n                                \"\\n                                    \" +\n                                  _vm._s(prizeInfo.title) +\n                                  \" (每次\" +\n                                  _vm._s(prizeInfo.drawCount || 1) +\n                                  \"人)\\n                                \"\n                              ),\n                            ]),\n                            _vm._v(\" \"),\n                            _c(\"div\", { staticClass: \"col-3\" }, [\n                              _vm._v(\n                                \"\\n                                    [\" +\n                                  _vm._s(prizeInfo.count) +\n                                  \" / \" +\n                                  _vm._s(prizeInfo.amount) +\n                                  \"]\\n                                \"\n                              ),\n                            ]),\n                          ]),\n                        ]\n                      )\n                    })\n                  : [\n                      _c(\"h4\", { staticClass: \"text-center p-3\" }, [\n                        _vm._v(\n                          \"\\n                            您尚未建立獎項，無法進行抽獎\\n                        \"\n                        ),\n                      ]),\n                      _vm._v(\" \"),\n                      _c(\n                        \"button\",\n                        {\n                          staticClass: \"btn btn-warning btn-block btn-lg\",\n                          on: { click: _vm.editPrizeList },\n                        },\n                        [\n                          _vm._v(\n                            \"\\n                            建立獎項\\n                        \"\n                          ),\n                        ]\n                      ),\n                    ],\n              ],\n              2\n            ),\n          ]),\n        ]),\n      ]),\n    ]\n  )\n}\nvar staticRenderFns = [\n  function () {\n    var _vm = this,\n      _c = _vm._self._c\n    return _c(\"div\", { staticClass: \"modal-header\" }, [\n      _c(\"h5\", { staticClass: \"modal-title\" }, [\n        _c(\"i\", { staticClass: \"fas fa-vote-yea\" }),\n        _vm._v(\"\\n                    選取獎項\\n                \"),\n      ]),\n      _vm._v(\" \"),\n      _c(\n        \"button\",\n        {\n          staticClass: \"close\",\n          attrs: {\n            type: \"button\",\n            \"data-dismiss\": \"modal\",\n            \"aria-label\": \"Close\",\n          },\n        },\n        [_c(\"span\", { attrs: { \"aria-hidden\": \"true\" } }, [_vm._v(\"×\")])]\n      ),\n    ])\n  },\n]\nrender._withStripped = true\n\nexport { render, staticRenderFns }","<template>\r\n    <div id=\"GetLuckyBox\" ref=\"box\" class=\"modal\" tabindex=\"-1\" role=\"dialog\" data-backdrop=\"static\"\r\n        data-keyboard=\"false\">\r\n        <div class=\"modal-dialog\" role=\"document\">\r\n            <div class=\"modal-content\">\r\n                <div class=\"modal-header\">\r\n                    <h5 class=\"modal-title\">\r\n                        <i class=\"fas fa-vote-yea\"></i>\r\n                        選取獎項\r\n                    </h5>\r\n                    <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\r\n                        <span aria-hidden=\"true\">&times;</span>\r\n                    </button>\r\n                </div>\r\n                <div class=\"modal-body\">\r\n                    <div v-if=\"needSetWebTitle\" role=\"alert\" class=\"alert alert-primary\" style=\"flex: 0 0 auto;\">\r\n                        請先設定屬於您的抽獎活動名稱\r\n                        <button class=\"btn btn-success btn-sm\" @click=\"gotoSetWebTitle\">立刻去</button>\r\n                    </div>\r\n                    <div class=\"get-lucky-list\" :class=\"{ disabled: needSetWebTitle }\">\r\n                        <template v-if=\"prizeListByAward.length > 0\">\r\n                            <button v-for=\"prizeInfo in prizeListByAward\" :key=\"prizeInfo.prize_sn\" type=\"button\"\r\n                                class=\"btn btn-success btn-lg btn-block mb-3 prizeInfo\"\r\n                                :disabled=\"prizeInfo.amount <= prizeInfo.count\" @click=\"getLucky(prizeInfo)\">\r\n                                <div class=\"row\">\r\n                                    <div class=\"col-9\">\r\n                                        {{ prizeInfo.title }} (每次{{ prizeInfo.drawCount || 1 }}人)\r\n                                    </div>\r\n                                    <div class=\"col-3\">\r\n                                        [{{ prizeInfo.count }} / {{ prizeInfo.amount }}]\r\n                                    </div>\r\n                                </div>\r\n                            </button>\r\n                        </template>\r\n                        <template v-else>\r\n                            <h4 class=\"text-center p-3\">\r\n                                您尚未建立獎項，無法進行抽獎\r\n                            </h4>\r\n                            <button class=\"btn btn-warning btn-block btn-lg\" @click=\"editPrizeList\">\r\n                                建立獎項\r\n                            </button>\r\n                        </template>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script>\r\nimport { mapActions, mapMutations, mapGetters } from 'vuex';\r\nimport { Tutorial, popup, trackJS } from 'lib/common/util';\r\n\r\nconst audio = {\r\n    ding: new Audio('./dist/mp3/ding.mp3'),\r\n    winner: [\r\n        // new Audio(\"./dist/mp3/winner1.mp3\"),\r\n        new Audio('./dist/mp3/winner2.mp3'),\r\n    ],\r\n};\r\n\r\n// import $ from 'jquery';\r\n// import 'bootstrap';\r\n\r\n// import 'app';\r\n// import { string, jsVars, popup, trackJS, localStorage, ppPanel } from 'lib/common/util';\r\n\r\nexport default {\r\n    components: {},\r\n    filters: {},\r\n    props: {},\r\n    data() {\r\n        return {};\r\n    },\r\n    computed: {\r\n        ...mapGetters([\r\n            'config',\r\n            'triggerOpenGetLucky',\r\n            'prizeListByAward',\r\n            'candidateList',\r\n            'haveAwardCandidateSN',\r\n            'getLuckyWaitTimeArr',\r\n        ]),\r\n        needSetWebTitle() {\r\n            const that = this;\r\n            let needSetWebTitle = false;\r\n            if (!that.config.isTutorial && (!that.config.webTitle || ['Lucky Draw', 'LuckyDraw', 'luckydraw'].includes(that.config.webTitle))) {\r\n                needSetWebTitle = true;\r\n            }\r\n            return needSetWebTitle;\r\n        },\r\n    },\r\n    watch: {\r\n        triggerOpenGetLucky: {\r\n            immediate: true,\r\n            handler() {\r\n                const that = this;\r\n                if (that.triggerOpenGetLucky) {\r\n                    $(that.$refs.box).modal('show');\r\n                } else {\r\n                    $(that.$refs.box).modal('hide');\r\n                }\r\n            },\r\n        },\r\n    },\r\n    created() { },\r\n    mounted() {\r\n        const that = this;\r\n        $(that.$refs.box).bind('shown.bs.modal', () => {\r\n            that.award = '';\r\n            trackJS.mixpanel('GetLuckyOpen_click');\r\n            trackJS.gtag('event', 'GetLuckyOpen_click');\r\n        });\r\n        $(that.$refs.box).bind('hidden.bs.modal', () => {\r\n            trackJS.mixpanel('GetLuckyClose_click');\r\n            trackJS.gtag('event', 'GetLuckyClose_click');\r\n            that.triggerModal({ key: 'GetLucky', close: true });\r\n        });\r\n\r\n        if (that.triggerOpenGetLucky) {\r\n            $(that.$refs.box).modal('show');\r\n        } else {\r\n            $(that.$refs.box).modal('hide');\r\n        }\r\n    },\r\n    updated() { },\r\n    destroyed() { },\r\n    methods: {\r\n        ...mapMutations({\r\n            setFavicon: 'setFavicon',\r\n            setFocusCandidateSN: 'setFocusCandidateSN',\r\n            setFocusPrizeSN: 'setFocusPrizeSN',\r\n            triggerModal: 'triggerModal',\r\n            setConfig: 'setConfig',\r\n            saveToLocalStorage: 'saveToLocalStorage',\r\n        }),\r\n        ...mapActions(['prepareLuckyDraw']),\r\n        gotoSetWebTitle() {\r\n            const that = this;\r\n            // that.triggerModal({ key: 'GetLucky', close: true });\r\n            // setTimeout(() => {\r\n            //     that.triggerModal({ key: 'Setting' });\r\n            // }, 100);\r\n\r\n            that.triggerModal({ key: 'GetLucky', close: true });\r\n            const config = {\r\n                offset: {\r\n                    top: 60,\r\n                    bottom: 60,\r\n                },\r\n                startCallback() {\r\n                    trackJS.mixpanel('TutorialStart_trigger', { type: 'WebsiteTitle' });\r\n                    trackJS.gtag('event', 'TutorialStart_trigger', { type: 'WebsiteTitle' });\r\n                },\r\n                closeCallback() {\r\n                    trackJS.mixpanel('TutorialEnd_trigger', { type: 'WebsiteTitle' });\r\n                    trackJS.gtag('event', 'TutorialEnd_trigger', { type: 'WebsiteTitle' });\r\n                },\r\n                step_callback(node, IntroInfo) {\r\n                    trackJS.mixpanel('TutorialStep_trigger', { type: 'WebsiteTitle', index: IntroInfo.index });\r\n                    trackJS.gtag('event', 'TutorialStep_trigger', { type: 'WebsiteTitle', index: IntroInfo.index });\r\n                },\r\n            };\r\n\r\n            const step = [\r\n                {\r\n                    target: '#SettingBox input[name=\"webTitle\"]',\r\n                    title: '獨特的抽獎',\r\n                    intro: '在抽獎前，設定一個屬於您的獨特抽獎活動名稱。',\r\n                    beforeAction(Element, TutorialNode, $next) {\r\n                        that.triggerModal({ key: 'Setting' });\r\n                        setTimeout(() => {\r\n                            $next();\r\n                        }, 500);\r\n                    },\r\n                },\r\n            ];\r\n            const tutorial1 = new Tutorial(step, config);\r\n            tutorial1.run();\r\n        },\r\n        editPrizeList() {\r\n            const that = this;\r\n            $(this.$refs.box).modal('hide');\r\n            that.triggerModal({ key: 'PrizeList' });\r\n        },\r\n        getLucky(prizeInfo) {\r\n            const that = this;\r\n            trackJS.mixpanel('GetLuckyChoosePrize_click', prizeInfo);\r\n            trackJS.gtag('event', 'GetLuckyChoosePrize_click', prizeInfo);\r\n\r\n            // 呼叫 Action 執行所有檢查和狀態準備\r\n            const result = that.prepareLuckyDraw(prizeInfo);\r\n\r\n            if (result === true) {\r\n                // 準備成功，關閉 Modal，等待 Enter 鍵\r\n                that.triggerModal({ key: 'GetLucky', close: true });\r\n            } else {\r\n                // 準備失敗 (數量不足等)，Popup 警告訊息已在 prepareLuckyDraw Action 內處理 (或在組件內處理)\r\n                // 這裡不再需要多餘的錯誤處理，因為 prepareLuckyDraw 會返回 false\r\n            }\r\n        },\r\n    },\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped></style>\r\n","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./main.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./main.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./main.vue?vue&type=template&id=3ad59205&scoped=true\"\nimport script from \"./main.vue?vue&type=script&lang=js\"\nexport * from \"./main.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3ad59205\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","ref","staticClass","attrs","id","tabindex","role","_m","_v","needSetWebTitle","staticStyle","flex","on","click","gotoSetWebTitle","_e","class","disabled","prizeListByAward","length","_l","prizeInfo","key","prize_sn","type","amount","count","$event","getLucky","_s","title","drawCount","editPrizeList","_withStripped","Audio","components","filters","props","data","computed","mapGetters","that","config","isTutorial","webTitle","includes","watch","triggerOpenGetLucky","immediate","handler","$","$refs","box","modal","created","mounted","bind","award","trackJS","mixpanel","gtag","triggerModal","close","updated","destroyed","methods","mapMutations","setFavicon","setFocusCandidateSN","setFocusPrizeSN","setConfig","saveToLocalStorage","mapActions","offset","top","bottom","startCallback","closeCallback","step_callback","node","IntroInfo","index","step","target","intro","beforeAction","Element","TutorialNode","$next","setTimeout","Tutorial","run","prepareLuckyDraw"],"sourceRoot":""}