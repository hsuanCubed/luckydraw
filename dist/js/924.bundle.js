"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[924],{8924:(t,e,i)=>{i.r(e),i.d(e,{default:()=>u});var n=function(){var t=this,e=t._self._c;return e("div",{ref:"box",staticClass:"modal",attrs:{id:"PrizeListBox",tabindex:"-1",role:"dialog"}},[e("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[e("h5",{staticClass:"modal-title"},[e("i",{staticClass:"fas fa-award"}),t._v("\n                    獎項名單 ["+t._s(t.inputPrizeListCnt.cnt)+" / "+t._s(t.inputPrizeListCnt.amount)+"]\n                ")]),t._v(" "),t._m(0)]),t._v(" "),e("div",{staticClass:"modal-body"},[e("draggable",{attrs:{handle:".handler"},on:{change:t.sortCallback},model:{value:t.inputPrizeList,callback:function(e){t.inputPrizeList=e},expression:"inputPrizeList"}},[e("transition-group",[t._l(t.inputPrizeList,(function(i){return[!1===i.del?[t.editPrizeInfo&&t.editPrizeInfo.prize_sn===i.prize_sn?e("div",{key:i.prize_sn,staticClass:"input-group mb-3"},[e("div",{staticClass:"input-group-prepend handler cursor-pointer"},[e("span",{staticClass:"input-group-text",attrs:{id:"basic-addon1"}},[e("i",{staticClass:"fas fa-bars"})])]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.editPrizeInfo.title,expression:"editPrizeInfo.title"}],staticClass:"form-control",attrs:{type:"text",placeholder:"編輯獎項名稱"},domProps:{value:t.editPrizeInfo.title},on:{input:function(e){e.target.composing||t.$set(t.editPrizeInfo,"title",e.target.value)}}}),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.editPrizeInfo.amount,expression:"editPrizeInfo.amount",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",placeholder:"總數量",min:"1",step:"1"},domProps:{value:t.editPrizeInfo.amount},on:{input:function(e){e.target.composing||t.$set(t.editPrizeInfo,"amount",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.editPrizeInfo.drawCount,expression:"editPrizeInfo.drawCount",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",placeholder:"每次抽幾人",min:"1",step:"1"},domProps:{value:t.editPrizeInfo.drawCount},on:{input:function(e){e.target.composing||t.$set(t.editPrizeInfo,"drawCount",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),e("div",{staticClass:"input-group-append"},[e("span",{staticClass:"input-group-text btn-success",staticStyle:{cursor:"pointer"},on:{click:t.saveEditPrizeAct}},[e("i",{staticClass:"far fa-save"})])])]):e("div",{key:i.prize_sn,staticClass:"input-group mb-3 prizeListGroup"},[e("div",{staticClass:"input-group-prepend handler cursor-pointer"},[e("span",{staticClass:"input-group-text",attrs:{id:"basic-addon1"}},[e("i",{staticClass:"fas fa-bars"})])]),t._v(" "),e("div",{staticClass:"form-control"},[t._v("\n                                        "+t._s(i.title)+" (總"+t._s(i.amount)+"名 / 每次"+t._s(i.drawCount||1)+"人)\n                                    ")]),t._v(" "),e("div",{staticClass:"input-group-append"},[e("span",{staticClass:"input-group-text",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.openEditPrize(i)}}},[e("i",{staticClass:"far fa-edit"})])]),t._v(" "),e("div",{staticClass:"input-group-append"},[e("span",{staticClass:"input-group-text",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.delPrizeAct(i)}}},[e("i",{staticClass:"fas fa-trash-alt"})])])])]:t._e()]}))],2)],1),t._v(" "),t.prizeList.length>0?[e("hr")]:t._e(),t._v(" "),t.addNewFlag?[e("div",{staticClass:"input-group mb-3",attrs:{id:"AddPrizeGroup"}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.newPrize.title,expression:"newPrize.title"}],staticClass:"form-control",attrs:{name:"title",type:"text",placeholder:"新增的獎項名稱"},domProps:{value:t.newPrize.title},on:{input:function(e){e.target.composing||t.$set(t.newPrize,"title",e.target.value)}}}),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.newPrize.amount,expression:"newPrize.amount",modifiers:{number:!0}}],staticClass:"form-control",attrs:{name:"amount",type:"number",placeholder:"總數量",min:"1",step:"1"},domProps:{value:t.newPrize.amount},on:{input:function(e){e.target.composing||t.$set(t.newPrize,"amount",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.newPrize.drawCount,expression:"newPrize.drawCount",modifiers:{number:!0}}],staticClass:"form-control",attrs:{name:"drawCount",type:"number",placeholder:"每次抽幾人",min:"1",step:"1"},domProps:{value:t.newPrize.drawCount},on:{input:function(e){e.target.composing||t.$set(t.newPrize,"drawCount",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),e("div",{staticClass:"input-group-append"},[e("span",{staticClass:"input-group-text",staticStyle:{cursor:"pointer"},on:{click:t.saveNewPrizeAct}},[e("i",{staticClass:"far fa-save"})])])])]:[e("button",{staticClass:"btn btn-info btn-block",attrs:{id:"AddPrize",type:"button"},on:{click:function(e){return t.openAddPrize(!0)}}},[t._v("\n                        新增獎項\n                    ")])]],2)])])])};n._withStripped=!0;var r=i(7111),s=i.n(r),a=i(1551),o=i(1582),l=i(4651);const d={components:{draggable:s()},filters:{},props:{},data:()=>({addNewFlag:!1,newPrize:{title:"",amount:1,drawCount:1},inputPrizeList:[],editPrizeInfo:null}),computed:{...(0,o.L8)(["triggerOpenPrizeList","prizeList"]),inputPrizeListCnt(){let t=0,e=0;return this.inputPrizeList.forEach((i=>{!1===i.del&&(t+=1,e+=i.amount)})),{cnt:t,amount:e}}},watch:{triggerOpenPrizeList:{handler(){this.triggerOpenPrizeList?l(this.$refs.box).modal("show"):l(this.$refs.box).modal("hide")}},inputPrizeList:{deep:!0,handler(){const t=this,e=JSON.stringify(t.prizeList),i=JSON.stringify(t.inputPrizeList);e!==i&&t.syncPrizeList(JSON.parse(i))}}},created(){},mounted(){const t=this;l(this.$refs.box).bind("shown.bs.modal",(()=>{t.inputPrizeList=JSON.parse(JSON.stringify(t.prizeList)),t.addNewFlag=!1,t.newPrize={title:"",amount:1,drawCount:1},0===t.inputPrizeList.length&&(t.addNewFlag=!0),t.editPrizeInfo=null,a.Xe.mixpanel("PrizeListOpen_click"),a.Xe.gtag("event","PrizeListOpen_click")})),l(t.$refs.box).bind("hidden.bs.modal",(()=>{a.Xe.mixpanel("PrizeListClose_click"),a.Xe.gtag("event","PrizeListClose_click")})),this.triggerOpenPrizeList?l(this.$refs.box).modal("show"):l(this.$refs.box).modal("hide")},updated(){},destroyed(){},methods:{...(0,o.i0)({}),...(0,o.PY)({syncPrizeList:"syncPrizeList"}),openAddPrize(){this.newPrize={title:"",amount:1,drawCount:1},this.addNewFlag=!0},saveNewPrizeAct(){const t=this;if(t.newPrize.title)if(JSON.parse(JSON.stringify(t.inputPrizeList)).map((t=>t.title)).includes(t.newPrize.title))a.lY.warning({html:"已有相同的獎項"});else{const e={prize_sn:a.Yj.getRandomString(10),title:"獎勵",amount:1,drawCount:1,del:!1,...t.newPrize};t.inputPrizeList.push(e),t.addNewFlag=!1,a.Xe.mixpanel("PrizeListAdd_click",e),a.Xe.gtag("event","PrizeListAdd_click",e)}else t.addNewFlag=!1},openEditPrize(t){this.editPrizeInfo=JSON.parse(JSON.stringify(t))},saveEditPrizeAct(){const t=this;if(t.editPrizeInfo){const e=JSON.parse(JSON.stringify(t.editPrizeInfo)),i=JSON.parse(JSON.stringify(t.inputPrizeList));let n=!1;if(i.forEach((t=>{t.prize_sn!==e.prize_sn&&t.title===e.title&&(n=!0)})),n)a.lY.warning({html:"已有相同的獎項"});else{let n=!1;i.forEach(((t,i)=>{t.prize_sn===e.prize_sn&&(n=i)})),!1===n?(i.del=!1,i.push(e)):i[n]=e,t.inputPrizeList=i,a.Xe.mixpanel("PrizeListEditSave_click",e),a.Xe.gtag("event","PrizeListEditSave_click",e),t.editPrizeInfo=null}}},delPrizeAct(t){const e=this;a.lY.warning({html:"您確定要刪除此筆獎項嗎？對應的得獎資訊也都會消除唷"},(()=>{const i=JSON.parse(JSON.stringify(e.inputPrizeList));let n=!1;i.forEach(((e,i)=>{e.prize_sn===t.prize_sn&&(n=i)})),!1!==n&&(i[n].del=!0,a.Xe.mixpanel("PrizeListEditDel_click",i[n]),a.Xe.gtag("event","PrizeListEditDel_click",i[n])),e.inputPrizeList=i}))},sortCallback(){const t=JSON.parse(JSON.stringify(this.inputPrizeList));a.Xe.mixpanel("PrizeListSort_trigger",t),a.Xe.gtag("event","PrizeListSort_trigger",t)}}},u=(0,i(2881).A)(d,n,[function(){var t=this._self._c;return t("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[t("span",{attrs:{"aria-hidden":"true"}},[this._v("×")])])}],!1,null,"247db200",null).exports}}]);
//# sourceMappingURL=924.bundle.js.map?v=bbe9758e910b654b2b4b